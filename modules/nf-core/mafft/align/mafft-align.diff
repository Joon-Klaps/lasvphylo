Changes in component 'nf-core/mafft/align'
'modules/nf-core/mafft/align/environment.yml' is unchanged
'modules/nf-core/mafft/align/meta.yml' is unchanged
Changes in 'mafft/align/main.nf':
--- modules/nf-core/mafft/align/main.nf
+++ modules/nf-core/mafft/align/main.nf
@@ -18,6 +18,7 @@
 
     output:
     tuple val(meta), path("*.fas{.gz,}"), emit: fas
+    tuple val(meta), path("*.patterns.txt"), emit: pattern
     path "versions.yml"                 , emit: versions
 
     when:
@@ -26,25 +27,28 @@
     script:
     def args         = task.ext.args   ?: ''
     def prefix       = task.ext.prefix ?: "${meta.id}"
-    def add          = add             ? "--add <(unpigz -cdf ${add})"                   : ''
-    def addfragments = addfragments    ? "--addfragments <(unpigz -cdf ${addfragments})" : ''
-    def addfull      = addfull         ? "--addfull <(unpigz -cdf ${addfull})"           : ''
-    def addprofile   = addprofile      ? "--addprofile <(unpigz -cdf ${addprofile})"     : ''
-    def addlong      = addlong         ? "--addlong <(unpigz -cdf ${addlong})"           : ''
+    def command_add          = add             ? "--add <(unpigz -cdf ${add})"                   : ''
+    def command_addfragments = addfragments    ? "--addfragments <(unpigz -cdf ${addfragments})" : ''
+    def command_addfull      = addfull         ? "--addfull <(unpigz -cdf ${addfull})"           : ''
+    def command_addprofile   = addprofile      ? "--addprofile <(unpigz -cdf ${addprofile})"     : ''
+    def command_addlong      = addlong         ? "--addlong <(unpigz -cdf ${addlong})"           : ''
     def write_output = compress ? " | pigz -cp ${task.cpus} > ${prefix}.fas.gz" : "> ${prefix}.fas"
     // this will not preserve MAFFTs return value, but mafft crashes when it receives a process substitution
     if ("$fasta" == "${prefix}.fas" ) error "Input and output names are the same, set prefix in module configuration to disambiguate!"
     """
     mafft \\
         --thread ${task.cpus} \\
-        ${add} \\
-        ${addfragments} \\
-        ${addfull} \\
-        ${addprofile} \\
-        ${addlong} \\
+        ${command_add} \\
+        ${command_addfragments} \\
+        ${command_addfull} \\
+        ${command_addprofile} \\
+        ${command_addlong} \\
         ${args} \\
         ${fasta} \\
-        ${write_output}
+        > tmp
+
+    sed "s/>_R_/>/g" tmp > ${prefix}.fas
+    grep ">" ${add} | sed "s/>//g" > ${prefix}.patterns.txt
 
     cat <<-END_VERSIONS > versions.yml
     "${task.process}":

'modules/nf-core/mafft/align/tests/main.nf.test.snap' is unchanged
'modules/nf-core/mafft/align/tests/main.nf.test' is unchanged
************************************************************
